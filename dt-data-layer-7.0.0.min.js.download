"use strict";(()=>{var W=Object.defineProperty;var L=(t,e)=>{for(var i in e)W(t,i,{get:e[i],enumerable:!0})};(function(){"use strict";var t=/\[object (Boolean|Number|String|Function|Array|Date|RegExp|Arguments)\]/;function e(o){return o==null?String(o):(o=t.exec(Object.prototype.toString.call(Object(o))))?o[1].toLowerCase():"object"}function i(o,r){return Object.prototype.hasOwnProperty.call(Object(o),r)}function n(o){if(!o||e(o)!="object"||o.nodeType||o==o.window)return!1;try{if(o.constructor&&!i(o,"constructor")&&!i(o.constructor.prototype,"isPrototypeOf"))return!1}catch{return!1}for(var r in o);return r===void 0||i(o,r)}function u(o,r){var s={},a=s;o=o.split(".");for(var p=0;p<o.length-1;p++)a=a[o[p]]={};return a[o[o.length-1]]=r,s}function m(o,r){var s=!o._clear,a;for(a in o)if(i(o,a)){var p=o[a];e(p)==="array"&&s?(e(r[a])==="array"||(r[a]=[]),m(p,r[a])):n(p)&&s?(n(r[a])||(r[a]={}),m(p,r[a])):r[a]=p}delete r._clear}function c(o,r,s){r=r===void 0?{}:r,typeof r=="function"?r={listener:r,listenToPast:s===void 0?!1:s,processNow:!0,commandProcessors:{}}:r={listener:r.listener||function(){},listenToPast:r.listenToPast||!1,processNow:r.processNow===void 0?!0:r.processNow,commandProcessors:r.commandProcessors||{}},this.a=o,this.l=r.listener,this.j=r.listenToPast,this.g=this.i=!1,this.c={},this.f=[],this.b=r.commandProcessors,this.h=v(this);var a=this.a.push,p=this;this.a.push=function(){var l=[].slice.call(arguments,0),g=a.apply(p.a,l);return w(p,l),g},r.processNow&&this.process()}c.prototype.process=function(){this.registerProcessor("set",function(){var s={};return arguments.length===1&&e(arguments[0])==="object"?s=arguments[0]:arguments.length===2&&e(arguments[0])==="string"&&(s=u(arguments[0],arguments[1])),s}),this.i=!0;for(var o=this.a.length,r=0;r<o;r++)w(this,[this.a[r]],!this.j)},c.prototype.get=function(o){var r=this.c;o=o.split(".");for(var s=0;s<o.length;s++){if(r[o[s]]===void 0)return;r=r[o[s]]}return r},c.prototype.flatten=function(){this.a.splice(0,this.a.length),this.a[0]={},m(this.c,this.a[0])},c.prototype.registerProcessor=function(o,r){o in this.b||(this.b[o]=[]),this.b[o].push(r)};function w(o,r,s){if(s=s===void 0?!1:s,o.i&&(o.f.push.apply(o.f,r),!o.g))for(;0<o.f.length;){if(r=o.f.shift(),e(r)==="array")t:{var a=o.c;e(r[0]);for(var p=r[0].split("."),l=p.pop(),g=r.slice(1),h=0;h<p.length;h++){if(a[p[h]]===void 0)break t;a=a[p[h]]}try{a[l].apply(a,g)}catch{}}else if(e(r)==="arguments"){if(p=o,l=[],g=r[0],p.b[g])for(a=p.b[g].length,h=0;h<a;h++)l.push(p.b[g][h].apply(p.h,[].slice.call(r,1)));o.f.push.apply(o.f,l)}else if(typeof r=="function")try{r.call(o.h)}catch{}else if(n(r))for(var x in r)m(u(x,r[x]),o.c);else continue;s||(o.g=!0,o.l(o.c,r),o.g=!1)}}c.prototype.registerProcessor=c.prototype.registerProcessor,c.prototype.flatten=c.prototype.flatten,c.prototype.get=c.prototype.get,c.prototype.process=c.prototype.process,window.DataLayerHelper=c;function v(o){return{set:function(r,s){m(u(r,s),o.c)},get:function(r){return o.get(r)}}}})();var D={};L(D,{clickEventTracker:()=>j});var B="https://spl.zeotap.com/fp?region=UK&eventType=s2s",b="Basic d19rOjk4YjVhYzVmLTJiNDctNDE5MS1hNTYxLTM5YTVmNTExMTMyZQ==",A="5eec8925b8e05c699f3a0af5";function Q(t){if(String(t).startsWith("/"))try{let e=window.location.origin!=="null"?window.location.origin:`${window.location.protocol}//${window.location.host}`;return String(new URL(t,e))}catch{}return String(t)}function k({text:t,description:e,url:i,location:n="Page",globalEvent:u}){typeof window<"u"&&window.skyDataLayer?.push({event:"click",globalEvent:u??!1,element:{text:t,description:e,url:i?Q(i):void 0,location:n},timestamp:Date.now()})}function X(t){let e=t.getAttribute("data-tracking")||"",i=t.querySelector('[data-tracking="false"')!=null||!1;return e==="false"||i}function j(){document.addEventListener("click",t=>{let e=t.target,i=e.closest("button")||e.closest("a");if(i){if(X(i))return;let u=!!i.querySelector(".PII")||i.classList.contains("PII")?"***redacted***":i.getAttribute("data-tracking-text")??e.textContent??"";k({text:u,url:i.getAttribute("data-tracking-url")??i.getAttribute("href")??void 0,description:i.getAttribute("data-tracking-description")??void 0,location:i.getAttribute("data-tracking-location")??void 0,globalEvent:!0})}},{capture:!0})}var P={};L(P,{defaultListener:()=>tt,zeotapListener:()=>I});async function I(t,e){let i=document.cookie.split("; ").find(u=>u.startsWith("uuid="))?.split("=")[1],n=await window.hasConsent?.({id:A});e?.event&&n&&fetch(B,{headers:{accept:"application/json",authorization:b},body:JSON.stringify({user:{id:i},event:{eventName:e.event,eventTimestamp:e.timestamp,...e},page:e.page}),method:"POST"})}function tt(t,e){}function S(t,e){e.event&&Object.values(P).forEach(i=>{i(t,e)})}var R="7.0.0";function T(){window.skyDataLayer?.push({event:"init",timestamp:Date.now(),globalEvent:!0,version:R})}function f(t){let e=document.cookie.replace(new RegExp(`(?:(?:^|.*;\\s*)${t}\\s*\\=\\s*([^;]*).*$)|^.*$`),"$1")||"";return decodeURIComponent(e)}function C(t){switch(t.toLowerCase()){case"ie":return"en-IE";case"gb":return"en-GB"}return""}function ot(t){try{let{searchParams:e}=new URL(t);return!!e.get("dcmp")}catch{return!1}}function rt(t,e){return ot(e)?"Campaign":t?"Search Engine":"Direct"}function it(t){try{let{host:e,pathname:i}=new URL(t),n=e.replace("www","").split(".").join(""),u=i.split("/").filter(Boolean);return u.length>0?`${n}:${u.join(":")}`:n}catch{return""}}function nt(){let t=f("geo").split("|")[1]??"";if(t)return C(t);let e=f("countryAKA");return e?C(e):""}function O({url:t,title:e,referrer:i,locale:n,channel:u,trafficSource:m,variant:c,saleType:w,intent:v,globalEvent:o}){typeof window<"u"&&window.skyDataLayer?.push({event:"view",globalEvent:o??!1,page:{title:e,referrer:i,url:t,locale:n??nt(),channel:u??it(t),trafficSource:m??rt(i,t)},experiment:{variant:c},journey:{saleType:w,intent:v},timestamp:Date.now()})}function N({products:t}){typeof window<"u"&&window.skyDataLayer?.push({event:"basketcreate",basket:{products:t},timestamp:Date.now()})}function H({sku:t,quantity:e,initialPrice:i,recurringPrice:n,paymentPlan:u}){typeof window<"u"&&window.skyDataLayer?.push({event:"basketadd",basket:{product:{sku:t,quantity:e,price:{initial:i,recurring:n},contract:{paymentPlan:u}}},timestamp:Date.now()})}function U({sku:t,quantity:e,initialPrice:i,recurringPrice:n}){typeof window<"u"&&window.skyDataLayer?.push({event:"basketremove",basket:{product:{sku:t,quantity:e,price:{initial:i,recurring:n}}},timestamp:Date.now()})}function _({cookies:t}){typeof window<"u"&&window.skyDataLayer?.push({event:"consent",user:{consent:{cookies:t}},timestamp:Date.now()})}function $({type:t}){typeof window<"u"&&window.skyDataLayer?.push({event:"logout",user:{type:t,loggedIn:!1},timestamp:Date.now()})}async function st(t){let i=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",i);return Array.from(new Uint8Array(n)).map(u=>u.toString(16).padStart(2,"0")).join("")}async function V(t){if(t)return st(t.toLowerCase())}async function G({orderId:t,products:e,totalValue:i,email:n}){typeof window<"u"&&window.skyDataLayer?.push({event:"checkout",order:{id:t,products:e,totalValue:i,hashedEmail:await V(n)},timestamp:Date.now()})}function z({type:t}){typeof window<"u"&&window.skyDataLayer?.push({event:"login",user:{type:t,loggedIn:!0},timestamp:Date.now()})}function Z({userId:t,name:e,appName:i,url:n,userAttributes:u,variant:m}){typeof window<"u"&&window.skyDataLayer?.push({event:"experimentation",experiment:{userId:t,name:e,appName:i,url:n,userAttributes:u,variant:m},timestamp:Date.now()})}function K({message:t}){typeof window<"u"&&window.skyDataLayer?.push({event:"error",error:{message:t},timestamp:Date.now()})}function q(t){typeof window<"u"&&window.skyDataLayer?.push({event:"media",media:t,timestamp:Date.now()})}var F=function(){let t=f("just"),e=f("skyCEsidexsso01"),i=f("skyCEsa01"),n=f("persistentLogin");return t&&e?"logged_in_accepted_persistent":t&&!e?"logged_in_declined_persistent":!t&&e||i?"logged_in":!t&&!e&&n?"login_expired":"not_logged_in"};function J({type:t,vipStatus:e,portfolio:i,productHolding:n}={}){typeof window<"u"&&window.skyDataLayer?.push({event:"user",user:{type:t,vipStatus:e,portfolio:i,productHolding:n,loggedIn:F(),customerProfileTrackingId:f("skyCEsidtrk01")??""},timestamp:Date.now()})}function E(t){for(let e in t)typeof t[e]!="function"&&(typeof t[e]=="object"&&t[e]!==null?E(t[e]):e==="event"?console.log(`%c${e}: ${t[e]}`,"font-weight: bold"):console.log(`	${e}: ${t[e]}`))}var y=class extends Array{constructor(e=[]){super(...e),this.pushView=O,this.pushClick=k,this.pushBasketCreate=N,this.pushBasketAdd=H,this.pushBasketRemove=U,this.pushConsent=_,this.pushCheckout=G,this.pushLogin=z,this.pushLogout=$,this.pushExperiment=Z,this.pushError=K,this.pushMedia=q,this.pushUser=J,this.prettyPrint=()=>E(this)}push(...e){return super.push(...e)}};function at(){T(),Object.values(D).forEach(t=>{t()})}typeof window<"u"&&(window.skyDataLayer?window.skyDataLayer=new y(window.skyDataLayer):window.skyDataLayer=new y,window.skyDataLayerHelper||(window.skyDataLayerHelper=new DataLayerHelper(window.skyDataLayer,{listener:S,listenToPast:!0,processNow:void 0,commandProcessors:void 0})),at());})();
//# sourceMappingURL=dt-data-layer.js.map
